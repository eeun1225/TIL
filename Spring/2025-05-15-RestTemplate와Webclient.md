# 📚 RestTemplate vs Webclient (2025.05.15)
___

## 🌟 오늘 배운 내용
API 호출할 떼 무엇을 이용하면 좋을 지 고민하다 작성해봄.
- RestTemplate
- WebClient
- 동기 / 비동기 & 블로킹 / 논블로킹 비교

<br/>


## 🔎 요약 정리

___

### ✅ RestTemplate

- 스프링 프레임워크에서 제공하는 HTTP 클라이언트 템플릿 클래스
- 제공하는 기능
    - 간편한 HTTP 요청 및 응답 처리
        - HTTP 요청 헤더, 본문 및 URL을 쉽게 설정하고 응답 상태 코드 및 본문을 추출할 수 있다.
    - 자동 메세지 변환
        - 기본적으로 JSON, XML, 바이너리 데이터 등 다양한 형식의 메시지를 자동으로 변환한다.
    - 인증 지원
        - 기본 인증, 다이제스트 인증, OAuth 등 다양한 인증 방식을 지원한다.
    - 편리한 예외 처리
        - HTTP 오류를 처리하고 예외를 발생시켜 응용 프로그램 코드를 간결하게 유지하는 데 도움이 된다.
- 장점과 단점
    - 장점 : 단순한 구조이며 많은 자료가 존재한다.
    - 단점 : 비동기 지원이 어렵고 커스터마이징이나 확장성이 부족하다.


### ✅ WebClient

- RestTemplate를 대체하는 HTTP 클라이언트이다.
- 기존의 동기 API를 제공할 뿐만 아니라 논블로킹 및 비동기 접근 방식을 지원해서 효율적인 통신이 가능하다.
- 빌더 방식의 인터페이스를 사용하며 외부 API로 요청을 할 때 리액티브 타입의 전송과 수신을 한다.
- 특징
    - 싱글 스레드 방식을 사용한다.
    - Non-Blocking 방식을 사용한다.
    - JSON, XML을 쉽게 응답받는다.


**Non-Blocking vs Blocking**

- Blocking
    - Application이 커널로 작업 요청을 할 때, 커널에서는 요청에 대한 로직을 실행한다.
    - 이 때, Application은 요청에 대한 응답을 받을 때까지 대기한다.
    - Application은 커널이 작업을 끝날 때까지 백그라운드에서 작업이 끝났는지 지속적으로 확인한다.
- Non-Blocking
    - Application이 요청을 하고 바로 제어권을 받는다.

**동기 vs 비동기**

- 동기
    - 프로그래밍에서 동기는 작업이 순차적으로 진행되는 것을 의미한다.
    - 호출한 함수 또는 작업이 반환될 때까지 대기하는 동안 실행 흐름이 차단된다.
    - 각 작업의 완료를 기다리는 동안 시간이 소요되어 전체 프로세스의 성능이 저하될 수 있다.
- 비동기
    - 작업의 완료 여부를 기다리지 않고 다른 작업을 실행할 수 있는 방식을 의미한다.
    - 주로 I/O 작업이나 네트워크 요청과 같이 시간이 오래 걸리는 작업에 유용하다.
    - 프로그램은 작업이 완료되기를 기다리는 동안 다른 작업을 처리할 수 있으므로 전체적인 성능이 향상된다.


### ✅ 동기 / 비동기 & 블로킹 / 논블로킹 비교

| 구분 | 동기-블로킹 (Sync-Blocking) | 동기-논블로킹 (Sync-NonBlocking) | 비동기-블로킹 (Async-Blocking) | 비동기-논블로킹 (Async-NonBlocking) |
| --- | --- | --- | --- | --- |
| 요청 방식 | 요청 후 결과까지 기다림 | 요청 후 바로 제어권 반환 | 콜백 요청하지만 응답 대기 | 콜백 요청 후 다른 작업 가능 |
| 제어권 흐름 | 커널 작업 중 앱 대기 | 커널 작업 중 앱이 계속 polling | 커널 작업 중 앱 대기 | 커널과 앱 모두 자유롭게 작동 |
| 특징 | 가장 직관적이고 단순함 | 직접 완료 여부 확인해야 함 | 비동기처럼 보이지만 실제는 blocking | 진짜 비동기 + 논블로킹 조합 |
| 병렬 작업 | ❌ 어렵다 | 🔄 polling으로 가능 | ❌ 블로킹이라 효율 낮음 | ✅ 가능, 자원 효율적 사용 |
| 예시 비유 | 전화 통화하면서 대화만 집중 | 문자 보내고 계속 확인 | 메시지 남겼지만 옆에서 대기 | 문자 보내고 답 오면 알림받기 |
| Java 예시 | `RestTemplate` | `RestTemplate + Thread/Polling` | 비효율적 `Future.get()` 사용 | `WebClient`, `CompletableFuture` 등 |